{"ast":null,"code":"import _objectSpread from\"C:/Users/Lenovo/Desktop/Capstone-Project/main-domain/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useRef,useState}from'react';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Inquiries=_ref=>{var _selectedChat$tenant,_selectedChat$tenant2,_selectedChat$tenant3,_selectedChat$tenant4,_selectedChat$tenant5,_selectedChat$message,_selectedChat$tenant6;let{isOpen,onClose}=_ref;const[activeTab,setActiveTab]=useState('chats');const[selectedChatId,setSelectedChatId]=useState(null);const[newMessage,setNewMessage]=useState('');const[inquiries,setInquiries]=useState([]);// inquiries from backend API\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[showAssignModal,setShowAssignModal]=useState(false);const[assigning,setAssigning]=useState(false);const hydratedRef=useRef(false);// Load inquiries from backend API\nconst loadInquiries=async()=>{try{setLoading(true);setError(null);const response=await api.getManagerInquiries();if(response&&response.inquiries){const mapped=response.inquiries.map(inquiry=>{var _inquiry$property,_inquiry$property2;return{id:inquiry.id,tenantName:inquiry.tenant_name,tenantEmail:inquiry.tenant_email,tenantPhone:inquiry.tenant_phone,property:((_inquiry$property=inquiry.property)===null||_inquiry$property===void 0?void 0:_inquiry$property.title)||((_inquiry$property2=inquiry.property)===null||_inquiry$property2===void 0?void 0:_inquiry$property2.building_name)||'Property',propertyId:inquiry.property_id,unitName:inquiry.unit_name,status:inquiry.status,messages:function(){const regex=/\\n\\n--- New Message(?: \\[(\\d{10,})\\])? ---\\n/g;const src=String(inquiry.message||'');const chunks=[];let last=0;let m;while((m=regex.exec(src))!==null){const txt=src.slice(last,m.index);if(txt)chunks.push({text:txt,ts:null});chunks.push({text:null,ts:m[1]?Number(m[1]):null});last=m.index+m[0].length;}const tail=src.slice(last);if(tail)chunks.push({text:tail,ts:null});const out=[];let pending=null;const now=Date.now();for(const c of chunks){if(c.text===null){pending=c.ts;continue;}out.push({id:\"\".concat(inquiry.id,\"-t-\").concat(out.length),sender:'tenant',text:c.text,time:new Date(pending||now).toLocaleTimeString([],{hour:'numeric',minute:'2-digit'})});pending=null;}// Parse manager replies split by our timestamped separators\nif(inquiry.response_message){const mSep=/\\n\\n--- Manager Reply \\[(\\d{10,})\\] ---\\n/g;const mSrc=String(inquiry.response_message||'');const mParts=[];let mLast=0;let mm;while((mm=mSep.exec(mSrc))!==null){const txt=mSrc.slice(mLast,mm.index);if(txt)mParts.push({text:txt,ts:null});mParts.push({text:null,ts:mm[1]?Number(mm[1]):null});mLast=mm.index+mm[0].length;}const mTail=mSrc.slice(mLast);if(mTail)mParts.push({text:mTail,ts:null});let mPending=null;for(const part of mParts){if(part.text===null){mPending=part.ts;continue;}out.push({id:\"\".concat(inquiry.id,\"-m-\").concat(out.length),sender:'manager',text:part.text,time:new Date(mPending||now).toLocaleTimeString([],{hour:'numeric',minute:'2-digit'})});mPending=null;}}return out;}(),inquiry:inquiry};});// Deduplicate by propertyId to ensure a single row per property\nconst dedup=[];const seen=new Set();for(const c of mapped){const key=String(c.propertyId);if(seen.has(key))continue;seen.add(key);dedup.push(c);}setInquiries(dedup);}}catch(err){console.error('Failed to load inquiries:',err);setError('Failed to load inquiries. Please try again.');}finally{setLoading(false);}};// Load inquiries on mount\nuseEffect(()=>{loadInquiries();hydratedRef.current=true;},[]);// Persist PM selection back so it opens same thread again\nuseEffect(()=>{if(!hydratedRef.current)return;try{if(selectedChatId)localStorage.setItem('pm_selected_chat_id',selectedChatId);}catch(_){}},[selectedChatId]);// Debug modal state\nuseEffect(()=>{console.log('showAssignModal state changed:',showAssignModal);},[showAssignModal]);const selectedChat=useMemo(()=>inquiries.find(c=>c.id===selectedChatId)||null,[inquiries,selectedChatId]);const handleSendMessage=async()=>{if(!newMessage.trim()||!selectedChat)return;try{setLoading(true);const response=await api.sendManagerMessage(selectedChat.id,newMessage.trim());if(response&&response.success){// Add the message to the inquiry\nsetInquiries(prev=>prev.map(c=>c.id===selectedChat.id?_objectSpread(_objectSpread({},c),{},{messages:[...(c.messages||[]),{id:Date.now(),sender:'manager',text:newMessage.trim(),time:new Date().toLocaleTimeString([],{hour:'numeric',minute:'2-digit'})}]}):c));setNewMessage('');}else{setError('Failed to send message. Please try again.');}}catch(err){console.error('Failed to send message:',err);setError('Failed to send message. Please try again.');}finally{setLoading(false);}};const markAsRead=inquiryId=>{// no-op for local prototype; could update a flag in local storage\n};const handleAssignTenant=async()=>{console.log('handleAssignTenant called');if(!selectedChat){console.log('No selectedChat found');return;}try{console.log('Starting assignment process');setAssigning(true);setError(null);// Call API to assign tenant to property\nconsole.log('Calling API with inquiry ID:',selectedChat.id,'property ID:',selectedChat.propertyId);const response=await api.assignTenantToProperty(selectedChat.id,selectedChat.propertyId);if(response&&response.success){// Update the inquiry status in the local state\nsetInquiries(prev=>prev.map(inquiry=>inquiry.id===selectedChat.id?_objectSpread(_objectSpread({},inquiry),{},{status:'assigned'}):inquiry));setShowAssignModal(false);// Show success message\nsetError(null);// You could add a success notification here\nconsole.log('Assignment successful:',response.message);}else{setError('Failed to assign tenant. Please try again.');}}catch(err){console.error('Failed to assign tenant:',err);setError('Failed to assign tenant. Please try again.');}finally{setAssigning(false);}};if(!isOpen)return null;if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-black bg-opacity-50 fixed inset-0\",onClick:onClose}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 h-[80vh] flex items-center justify-center relative z-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading inquiries...\"})]})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-black bg-opacity-50 fixed inset-0\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 h-[80vh] flex flex-col relative z-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900\",children:\"Property Inquiries\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Manage tenant inquiries for your properties\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border-l-4 border-red-400 p-4 mx-6 mt-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-red-700\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"text-xs text-red-600 underline mt-1\",children:\"Dismiss\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex border-b\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('chats'),className:\"px-6 py-3 font-medium \".concat(activeTab==='chats'?'text-blue-600 border-b-2 border-blue-600':'text-gray-500 hover:text-gray-700'),children:[\"Active Chats (\",inquiries.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('new'),className:\"px-6 py-3 font-medium \".concat(activeTab==='new'?'text-blue-600 border-b-2 border-blue-600':'text-gray-500 hover:text-gray-700'),children:[\"New Inquiries (\",inquiries.filter(i=>i.status==='new').length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-hidden\",children:activeTab==='chats'?/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1/3 border-r overflow-y-auto\",children:inquiries.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 text-center text-gray-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"mx-auto h-12 w-12 text-gray-400\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.456L3 21l2.456-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z\"})})}),/*#__PURE__*/_jsx(\"p\",{children:\"No inquiries yet.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1\",children:\"Inquiries will appear here when tenants contact you about your properties.\"})]}):inquiries.map(inquiry=>{var _inquiry$messages,_inquiry$messages2;return/*#__PURE__*/_jsx(\"div\",{onClick:()=>{setSelectedChatId(inquiry.id);if(inquiry.unread_count>0){markAsRead(inquiry.id);}},className:\"p-4 border-b cursor-pointer hover:bg-gray-50 \".concat(selectedChatId===inquiry.id?'bg-blue-50 border-blue-200':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 font-medium\",children:(inquiry.avatar||inquiry.managerName||'PM').toString().slice(0,2).toUpperCase()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900 truncate\",children:inquiry.managerName||'Property Manager'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 truncate\",children:inquiry.unitName?\"\".concat(inquiry.unitName,\"/\").concat(inquiry.property):inquiry.property||'Property'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:((_inquiry$messages=inquiry.messages)===null||_inquiry$messages===void 0?void 0:(_inquiry$messages2=_inquiry$messages[inquiry.messages.length-1])===null||_inquiry$messages2===void 0?void 0:_inquiry$messages2.time)||'No messages'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-end space-y-1\",children:[inquiry.unread_count>0&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-blue-600 text-white text-xs rounded-full px-2 py-1\",children:inquiry.unread_count}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-1 rounded-full \".concat(inquiry.status==='new'?'bg-green-100 text-green-800':inquiry.status==='active'?'bg-blue-100 text-blue-800':inquiry.status==='assigned'?'bg-purple-100 text-purple-800':inquiry.status==='responded'?'bg-yellow-100 text-yellow-800':'bg-gray-100 text-gray-800'),children:inquiry.status||'active'})]})]})},inquiry.id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex flex-col\",children:selectedChat?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:selectedChat.tenantName||((_selectedChat$tenant=selectedChat.tenant)===null||_selectedChat$tenant===void 0?void 0:_selectedChat$tenant.name)}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Interested in: \",selectedChat.unitName?\"\".concat(selectedChat.unitName,\"/\").concat(selectedChat.property):selectedChat.property||'Property']}),(selectedChat.tenantEmail||((_selectedChat$tenant2=selectedChat.tenant)===null||_selectedChat$tenant2===void 0?void 0:_selectedChat$tenant2.email)||selectedChat.tenantPhone||((_selectedChat$tenant3=selectedChat.tenant)===null||_selectedChat$tenant3===void 0?void 0:_selectedChat$tenant3.phone))&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:[selectedChat.tenantEmail||((_selectedChat$tenant4=selectedChat.tenant)===null||_selectedChat$tenant4===void 0?void 0:_selectedChat$tenant4.email),selectedChat.tenantPhone||((_selectedChat$tenant5=selectedChat.tenant)===null||_selectedChat$tenant5===void 0?void 0:_selectedChat$tenant5.phone)].filter(Boolean).join(' • ')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[selectedChat.status!=='assigned'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('Assign to Tenant button clicked');setShowAssignModal(true);},className:\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm font-medium transition-colors\",children:\"Assign to Tenant\"}),selectedChat.status==='assigned'&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-purple-100 text-purple-800 px-3 py-2 rounded-lg text-sm font-medium\",children:\"\\u2713 Assigned\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:selectedChat.price&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-blue-600\",children:selectedChat.price})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:((_selectedChat$message=selectedChat.messages)===null||_selectedChat$message===void 0?void 0:_selectedChat$message.length)===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-gray-500 py-8\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No messages yet. The tenant is waiting for your response!\"})}):(selectedChat.messages||[]).map(message=>/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(message.sender==='manager'?'justify-end':'justify-start'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xs lg:max-w-md px-4 py-2 rounded-lg \".concat(message.sender==='manager'?'bg-blue-600 text-white':'bg-gray-200 text-gray-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:message.text||message.content}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mt-1 \".concat(message.sender==='manager'?'text-blue-100':'text-gray-500'),children:message.time||(message.created_at?new Date(message.created_at).toLocaleTimeString():'')})]})},message.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type your response...\",className:\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black placeholder-gray-400\",onKeyPress:e=>e.key==='Enter'&&handleSendMessage()}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,disabled:!newMessage.trim(),className:\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Send\"})]})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex items-center justify-center text-gray-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"mx-auto h-12 w-12 text-gray-400 mb-4\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.456L3 21l2.456-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z\"})}),/*#__PURE__*/_jsx(\"p\",{children:\"Select an inquiry to view messages\"})]})})})]}):/*#__PURE__*//* New Inquiries Tab */_jsx(\"div\",{className:\"p-6 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:inquiries.filter(i=>i.status==='new').length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-gray-500 py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"mx-auto h-12 w-12 text-gray-400\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4\"})})}),/*#__PURE__*/_jsx(\"p\",{children:\"No new inquiries\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1\",children:\"New tenant inquiries will appear here.\"})]}):inquiries.filter(i=>i.status==='new').map(inquiry=>{var _inquiry$property3,_inquiry$property3$im,_inquiry$property4,_inquiry$tenant,_inquiry$tenant2;return/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg p-4 hover:shadow-md transition-shadow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4\",children:[/*#__PURE__*/_jsx(\"img\",{src:((_inquiry$property3=inquiry.property)===null||_inquiry$property3===void 0?void 0:(_inquiry$property3$im=_inquiry$property3.images)===null||_inquiry$property3$im===void 0?void 0:_inquiry$property3$im[0])||'/placeholder-property.jpg',alt:(_inquiry$property4=inquiry.property)===null||_inquiry$property4===void 0?void 0:_inquiry$property4.title,className:\"w-16 h-16 object-cover rounded-lg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900\",children:(_inquiry$tenant=inquiry.tenant)===null||_inquiry$tenant===void 0?void 0:_inquiry$tenant.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:(_inquiry$tenant2=inquiry.tenant)===null||_inquiry$tenant2===void 0?void 0:_inquiry$tenant2.email}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:[\"Interested in: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:inquiry.unitName?\"\".concat(inquiry.unitName,\"/\").concat(inquiry.property):inquiry.property||'Property'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full\",children:\"New\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:new Date(inquiry.created_at).toLocaleDateString()})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedChatId(inquiry.id);setActiveTab('chats');markAsRead(inquiry.id);},className:\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm\",children:\"Respond\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 text-sm\",children:\"View Property\"})]})]})]})},inquiry.id);})})})})]}),showAssignModal&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-[100] flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-50\",onClick:()=>setShowAssignModal(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 z-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 13l4 4L19 7\"})})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Assign Tenant to Unit\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-4\",children:[\"Are you sure you want to assign \",/*#__PURE__*/_jsx(\"strong\",{children:(selectedChat===null||selectedChat===void 0?void 0:selectedChat.tenantName)||(selectedChat===null||selectedChat===void 0?void 0:(_selectedChat$tenant6=selectedChat.tenant)===null||_selectedChat$tenant6===void 0?void 0:_selectedChat$tenant6.name)||'this tenant'}),\" to \",/*#__PURE__*/_jsx(\"strong\",{children:(selectedChat===null||selectedChat===void 0?void 0:selectedChat.unitName)||'a unit'}),\" in \",/*#__PURE__*/_jsx(\"strong\",{children:(selectedChat===null||selectedChat===void 0?void 0:selectedChat.property)||'this property'}),\"?\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-yellow-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Warning:\"}),\" This will change the unit status from vacant to occupied and create a tenancy record.\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAssignModal(false),disabled:assigning,className:\"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAssignTenant,disabled:assigning,className:\"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors\",children:assigning?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Assigning...\"]}):'Confirm Assignment'})]})]})})]})]});};export default Inquiries;","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Inquiries","_ref","_selectedChat$tenant","_selectedChat$tenant2","_selectedChat$tenant3","_selectedChat$tenant4","_selectedChat$tenant5","_selectedChat$message","_selectedChat$tenant6","isOpen","onClose","activeTab","setActiveTab","selectedChatId","setSelectedChatId","newMessage","setNewMessage","inquiries","setInquiries","loading","setLoading","error","setError","showAssignModal","setShowAssignModal","assigning","setAssigning","hydratedRef","loadInquiries","response","getManagerInquiries","mapped","map","inquiry","_inquiry$property","_inquiry$property2","id","tenantName","tenant_name","tenantEmail","tenant_email","tenantPhone","tenant_phone","property","title","building_name","propertyId","property_id","unitName","unit_name","status","messages","regex","src","String","message","chunks","last","m","exec","txt","slice","index","push","text","ts","Number","length","tail","out","pending","now","Date","c","concat","sender","time","toLocaleTimeString","hour","minute","response_message","mSep","mSrc","mParts","mLast","mm","mTail","mPending","part","dedup","seen","Set","key","has","add","err","console","current","localStorage","setItem","_","log","selectedChat","find","handleSendMessage","trim","sendManagerMessage","success","prev","_objectSpread","markAsRead","inquiryId","handleAssignTenant","assignTenantToProperty","className","children","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","filter","i","_inquiry$messages","_inquiry$messages2","unread_count","avatar","managerName","toString","toUpperCase","tenant","name","email","phone","Boolean","join","price","content","created_at","type","value","onChange","e","target","placeholder","onKeyPress","disabled","_inquiry$property3","_inquiry$property3$im","_inquiry$property4","_inquiry$tenant","_inquiry$tenant2","images","alt","toLocaleDateString","cx","cy","r"],"sources":["C:/Users/Lenovo/Desktop/Capstone-Project/main-domain/frontend/src/components/PropertyManager/Inquiries.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport api from '../../services/api';\r\n\r\nconst Inquiries = ({ isOpen, onClose }) => {\r\n  const [activeTab, setActiveTab] = useState('chats');\r\n  const [selectedChatId, setSelectedChatId] = useState(null);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [inquiries, setInquiries] = useState([]); // inquiries from backend API\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [showAssignModal, setShowAssignModal] = useState(false);\r\n  const [assigning, setAssigning] = useState(false);\r\n  const hydratedRef = useRef(false);\r\n\r\n  // Load inquiries from backend API\r\n  const loadInquiries = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await api.getManagerInquiries();\r\n      if (response && response.inquiries) {\r\n        const mapped = response.inquiries.map(inquiry => ({\r\n          id: inquiry.id,\r\n          tenantName: inquiry.tenant_name,\r\n          tenantEmail: inquiry.tenant_email,\r\n          tenantPhone: inquiry.tenant_phone,\r\n          property: inquiry.property?.title || inquiry.property?.building_name || 'Property',\r\n          propertyId: inquiry.property_id,\r\n          unitName: inquiry.unit_name,\r\n          status: inquiry.status,\r\n          messages: (function(){\r\n            const regex = /\\n\\n--- New Message(?: \\[(\\d{10,})\\])? ---\\n/g;\r\n            const src = String(inquiry.message || '');\r\n            const chunks = []; let last = 0; let m;\r\n            while ((m = regex.exec(src)) !== null) {\r\n              const txt = src.slice(last, m.index);\r\n              if (txt) chunks.push({ text: txt, ts: null });\r\n              chunks.push({ text: null, ts: m[1] ? Number(m[1]) : null });\r\n              last = m.index + m[0].length;\r\n            }\r\n            const tail = src.slice(last); if (tail) chunks.push({ text: tail, ts: null });\r\n            const out = []; let pending = null; const now = Date.now();\r\n            for (const c of chunks) {\r\n              if (c.text === null) { pending = c.ts; continue; }\r\n              out.push({ id: `${inquiry.id}-t-${out.length}`, sender: 'tenant', text: c.text, time: new Date(pending || now).toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' }) });\r\n              pending = null;\r\n            }\r\n            // Parse manager replies split by our timestamped separators\r\n            if (inquiry.response_message) {\r\n              const mSep = /\\n\\n--- Manager Reply \\[(\\d{10,})\\] ---\\n/g;\r\n              const mSrc = String(inquiry.response_message || '');\r\n              const mParts = []; let mLast = 0; let mm;\r\n              while ((mm = mSep.exec(mSrc)) !== null) {\r\n                const txt = mSrc.slice(mLast, mm.index);\r\n                if (txt) mParts.push({ text: txt, ts: null });\r\n                mParts.push({ text: null, ts: mm[1] ? Number(mm[1]) : null });\r\n                mLast = mm.index + mm[0].length;\r\n              }\r\n              const mTail = mSrc.slice(mLast); if (mTail) mParts.push({ text: mTail, ts: null });\r\n              let mPending = null;\r\n              for (const part of mParts) {\r\n                if (part.text === null) { mPending = part.ts; continue; }\r\n                out.push({ id: `${inquiry.id}-m-${out.length}`, sender: 'manager', text: part.text, time: new Date(mPending || now).toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' }) });\r\n                mPending = null;\r\n              }\r\n            }\r\n            return out;\r\n          })(),\r\n          inquiry: inquiry\r\n        }));\r\n        // Deduplicate by propertyId to ensure a single row per property\r\n        const dedup = [];\r\n        const seen = new Set();\r\n        for (const c of mapped) {\r\n          const key = String(c.propertyId);\r\n          if (seen.has(key)) continue;\r\n          seen.add(key);\r\n          dedup.push(c);\r\n        }\r\n        setInquiries(dedup);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load inquiries:', err);\r\n      setError('Failed to load inquiries. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Load inquiries on mount\r\n  useEffect(() => {\r\n    loadInquiries();\r\n    hydratedRef.current = true;\r\n  }, []);\r\n\r\n  // Persist PM selection back so it opens same thread again\r\n  useEffect(() => {\r\n    if (!hydratedRef.current) return;\r\n    try { if (selectedChatId) localStorage.setItem('pm_selected_chat_id', selectedChatId); } catch (_) {}\r\n  }, [selectedChatId]);\r\n\r\n  // Debug modal state\r\n  useEffect(() => {\r\n    console.log('showAssignModal state changed:', showAssignModal);\r\n  }, [showAssignModal]);\r\n\r\n  const selectedChat = useMemo(() => inquiries.find(c => c.id === selectedChatId) || null, [inquiries, selectedChatId]);\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!newMessage.trim() || !selectedChat) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const response = await api.sendManagerMessage(selectedChat.id, newMessage.trim());\r\n      \r\n      if (response && response.success) {\r\n        // Add the message to the inquiry\r\n        setInquiries(prev => prev.map(c => c.id === selectedChat.id ? {\r\n          ...c,\r\n          messages: [...(c.messages || []), { \r\n            id: Date.now(), \r\n            sender: 'manager', \r\n            text: newMessage.trim(), \r\n            time: new Date().toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' }) \r\n          }]\r\n        } : c));\r\n        setNewMessage('');\r\n      } else {\r\n        setError('Failed to send message. Please try again.');\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to send message:', err);\r\n      setError('Failed to send message. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const markAsRead = (inquiryId) => {\r\n    // no-op for local prototype; could update a flag in local storage\r\n  };\r\n\r\n  const handleAssignTenant = async () => {\r\n    console.log('handleAssignTenant called');\r\n    if (!selectedChat) {\r\n      console.log('No selectedChat found');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      console.log('Starting assignment process');\r\n      setAssigning(true);\r\n      setError(null);\r\n      \r\n      // Call API to assign tenant to property\r\n      console.log('Calling API with inquiry ID:', selectedChat.id, 'property ID:', selectedChat.propertyId);\r\n      const response = await api.assignTenantToProperty(selectedChat.id, selectedChat.propertyId);\r\n      \r\n      if (response && response.success) {\r\n        // Update the inquiry status in the local state\r\n        setInquiries(prev => prev.map(inquiry => \r\n          inquiry.id === selectedChat.id \r\n            ? { ...inquiry, status: 'assigned' }\r\n            : inquiry\r\n        ));\r\n        \r\n        setShowAssignModal(false);\r\n        // Show success message\r\n        setError(null);\r\n        // You could add a success notification here\r\n        console.log('Assignment successful:', response.message);\r\n      } else {\r\n        setError('Failed to assign tenant. Please try again.');\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to assign tenant:', err);\r\n      setError('Failed to assign tenant. Please try again.');\r\n    } finally {\r\n      setAssigning(false);\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n        <div className=\"bg-black bg-opacity-50 fixed inset-0\" onClick={onClose}></div>\r\n        <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 h-[80vh] flex items-center justify-center relative z-10\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n            <p className=\"text-gray-600\">Loading inquiries...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      {/* Backdrop */}\r\n      <div className=\"bg-black bg-opacity-50 fixed inset-0\" onClick={onClose}></div>\r\n      \r\n      {/* Modal Content */}\r\n      <div className=\"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 h-[80vh] flex flex-col relative z-10\">\r\n        {/* Header */}\r\n        <div className=\"p-6 border-b flex items-center justify-between\">\r\n          <div>\r\n            <h2 className=\"text-xl font-semibold text-gray-900\">Property Inquiries</h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">Manage tenant inquiries for your properties</p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"bg-red-50 border-l-4 border-red-400 p-4 mx-6 mt-2\">\r\n            <div className=\"flex\">\r\n              <div className=\"ml-3\">\r\n                <p className=\"text-sm text-red-700\">{error}</p>\r\n                <button \r\n                  onClick={() => setError(null)}\r\n                  className=\"text-xs text-red-600 underline mt-1\"\r\n                >\r\n                  Dismiss\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex border-b\">\r\n        <button\r\n          onClick={() => setActiveTab('chats')}\r\n          className={`px-6 py-3 font-medium ${\r\n            activeTab === 'chats'\r\n              ? 'text-blue-600 border-b-2 border-blue-600'\r\n              : 'text-gray-500 hover:text-gray-700'\r\n          }`}\r\n        >\r\n          Active Chats ({inquiries.length})\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab('new')}\r\n          className={`px-6 py-3 font-medium ${\r\n            activeTab === 'new'\r\n              ? 'text-blue-600 border-b-2 border-blue-600'\r\n              : 'text-gray-500 hover:text-gray-700'\r\n          }`}\r\n        >\r\n          New Inquiries ({inquiries.filter(i => i.status === 'new').length})\r\n        </button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-hidden\">\r\n        {activeTab === 'chats' ? (\r\n          <div className=\"flex h-full\">\r\n            {/* Chat List */}\r\n            <div className=\"w-1/3 border-r overflow-y-auto\">\r\n                {inquiries.length === 0 ? (\r\n                <div className=\"p-6 text-center text-gray-500\">\r\n                  <div className=\"mb-4\">\r\n                    <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.456L3 21l2.456-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z\" />\r\n                    </svg>\r\n                  </div>\r\n                  <p>No inquiries yet.</p>\r\n                  <p className=\"text-sm mt-1\">Inquiries will appear here when tenants contact you about your properties.</p>\r\n                </div>\r\n                ) : (\r\n                inquiries.map((inquiry) => (\r\n                  <div\r\n                    key={inquiry.id}\r\n                    onClick={() => {\r\n                      setSelectedChatId(inquiry.id);\r\n                      if (inquiry.unread_count > 0) {\r\n                        markAsRead(inquiry.id);\r\n                      }\r\n                    }}\r\n                    className={`p-4 border-b cursor-pointer hover:bg-gray-50 ${\r\n                      selectedChatId === inquiry.id ? 'bg-blue-50 border-blue-200' : ''\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center\">\r\n                        <span className=\"text-gray-600 font-medium\">\r\n                          {(inquiry.avatar || (inquiry.managerName || 'PM')).toString().slice(0,2).toUpperCase()}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-sm font-medium text-gray-900 truncate\">\r\n                          {inquiry.managerName || 'Property Manager'}\r\n                        </p>\r\n                        <p className=\"text-sm text-gray-500 truncate\">\r\n                          {inquiry.unitName ? `${inquiry.unitName}/${inquiry.property}` : inquiry.property || 'Property'}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-400\">\r\n                          {inquiry.messages?.[inquiry.messages.length - 1]?.time || 'No messages'}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"flex flex-col items-end space-y-1\">\r\n                        {inquiry.unread_count > 0 && (\r\n                          <span className=\"bg-blue-600 text-white text-xs rounded-full px-2 py-1\">\r\n                            {inquiry.unread_count}\r\n                          </span>\r\n                        )}\r\n                        <span className={`text-xs px-2 py-1 rounded-full ${\r\n                          inquiry.status === 'new' ? 'bg-green-100 text-green-800' :\r\n                          inquiry.status === 'active' ? 'bg-blue-100 text-blue-800' :\r\n                          inquiry.status === 'assigned' ? 'bg-purple-100 text-purple-800' :\r\n                          inquiry.status === 'responded' ? 'bg-yellow-100 text-yellow-800' :\r\n                          'bg-gray-100 text-gray-800'\r\n                        }`}>\r\n                          {inquiry.status || 'active'}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n\r\n            {/* Chat Messages */}\r\n            <div className=\"flex-1 flex flex-col\">\r\n              {selectedChat ? (\r\n                <>\r\n                  {/* Chat Header */}\r\n                  <div className=\"p-4 border-b bg-gray-50\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <h3 className=\"font-medium text-gray-900\">{selectedChat.tenantName || selectedChat.tenant?.name}</h3>\r\n                        <p className=\"text-sm text-gray-500\">\r\n                          Interested in: {selectedChat.unitName ? `${selectedChat.unitName}/${selectedChat.property}` : selectedChat.property || 'Property'}\r\n                        </p>\r\n                        {(selectedChat.tenantEmail || selectedChat.tenant?.email || selectedChat.tenantPhone || selectedChat.tenant?.phone) && (\r\n                          <p className=\"text-xs text-gray-400\">\r\n                            {[selectedChat.tenantEmail || selectedChat.tenant?.email, selectedChat.tenantPhone || selectedChat.tenant?.phone].filter(Boolean).join(' • ')}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        {selectedChat.status !== 'assigned' && (\r\n                          <button\r\n                            onClick={() => {\r\n                              console.log('Assign to Tenant button clicked');\r\n                              setShowAssignModal(true);\r\n                            }}\r\n                            className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm font-medium transition-colors\"\r\n                          >\r\n                            Assign to Tenant\r\n                          </button>\r\n                        )}\r\n                        {selectedChat.status === 'assigned' && (\r\n                          <span className=\"bg-purple-100 text-purple-800 px-3 py-2 rounded-lg text-sm font-medium\">\r\n                            ✓ Assigned\r\n                          </span>\r\n                        )}\r\n                        <div className=\"text-right\">\r\n                          {selectedChat.price && (\r\n                            <p className=\"text-sm font-medium text-blue-600\">\r\n                              {selectedChat.price}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Messages */}\r\n                  <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                    {selectedChat.messages?.length === 0 ? (\r\n                      <div className=\"text-center text-gray-500 py-8\">\r\n                        <p>No messages yet. The tenant is waiting for your response!</p>\r\n                      </div>\r\n                    ) : (\r\n                      (selectedChat.messages || []).map((message) => (\r\n                        <div\r\n                          key={message.id}\r\n                          className={`flex ${message.sender === 'manager' ? 'justify-end' : 'justify-start'}`}\r\n                        >\r\n                          <div\r\n                            className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${\r\n                              message.sender === 'manager' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-900'\r\n                            }`}\r\n                          >\r\n                            <p className=\"text-sm\">{message.text || message.content}</p>\r\n                            <p className={`text-xs mt-1 ${message.sender === 'manager' ? 'text-blue-100' : 'text-gray-500'}`}>\r\n                              {message.time || (message.created_at ? new Date(message.created_at).toLocaleTimeString() : '')}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      ))\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Message Input */}\r\n                  <div className=\"p-4 border-t\">\r\n                    <div className=\"flex space-x-2\">\r\n                      <input\r\n                        type=\"text\"\r\n                        value={newMessage}\r\n                        onChange={(e) => setNewMessage(e.target.value)}\r\n                        placeholder=\"Type your response...\"\r\n                        className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black placeholder-gray-400\"\r\n                        onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\r\n                      />\r\n                      <button\r\n                        onClick={handleSendMessage}\r\n                        disabled={!newMessage.trim()}\r\n                        className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                      >\r\n                        Send\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <div className=\"flex-1 flex items-center justify-center text-gray-500\">\r\n                  <div className=\"text-center\">\r\n                    <svg className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.456L3 21l2.456-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z\" />\r\n                    </svg>\r\n                    <p>Select an inquiry to view messages</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          /* New Inquiries Tab */\r\n          <div className=\"p-6 overflow-y-auto\">\r\n            <div className=\"space-y-4\">\r\n              {inquiries.filter(i => i.status === 'new').length === 0 ? (\r\n                <div className=\"text-center text-gray-500 py-8\">\r\n                  <div className=\"mb-4\">\r\n                    <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4\" />\r\n                    </svg>\r\n                  </div>\r\n                  <p>No new inquiries</p>\r\n                  <p className=\"text-sm mt-1\">New tenant inquiries will appear here.</p>\r\n                </div>\r\n              ) : (\r\n                inquiries.filter(i => i.status === 'new').map((inquiry) => (\r\n                  <div key={inquiry.id} className=\"border rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n                    <div className=\"flex items-start space-x-4\">\r\n                      <img\r\n                        src={inquiry.property?.images?.[0] || '/placeholder-property.jpg'}\r\n                        alt={inquiry.property?.title}\r\n                        className=\"w-16 h-16 object-cover rounded-lg\"\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-start justify-between\">\r\n                          <div>\r\n                            <h4 className=\"font-medium text-gray-900\">{inquiry.tenant?.name}</h4>\r\n                            <p className=\"text-sm text-gray-600\">{inquiry.tenant?.email}</p>\r\n                            <p className=\"text-sm text-gray-500 mt-1\">\r\n                              Interested in: <span className=\"font-medium\">{inquiry.unitName ? `${inquiry.unitName}/${inquiry.property}` : inquiry.property || 'Property'}</span>\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <span className=\"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full\">\r\n                              New\r\n                            </span>\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                              {new Date(inquiry.created_at).toLocaleDateString()}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"mt-3 flex space-x-2\">\r\n                          <button\r\n                            onClick={() => {\r\n                              setSelectedChatId(inquiry.id);\r\n                              setActiveTab('chats');\r\n                              markAsRead(inquiry.id);\r\n                            }}\r\n                            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm\"\r\n                          >\r\n                            Respond\r\n                          </button>\r\n                          <button className=\"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 text-sm\">\r\n                            View Property\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      </div>\r\n\r\n      {/* Assign Tenant Confirmation Modal */}\r\n      {showAssignModal && (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center\">\r\n          {/* Backdrop */}\r\n          <div \r\n            className=\"absolute inset-0 bg-black bg-opacity-50\" \r\n            onClick={() => setShowAssignModal(false)}\r\n          ></div>\r\n          \r\n          {/* Modal Content */}\r\n          <div className=\"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 z-10\">\r\n            <div className=\"p-6\">\r\n              {/* Header */}\r\n              <div className=\"flex items-center mb-4\">\r\n                <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3\">\r\n                  <svg className=\"w-6 h-6 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                  </svg>\r\n                </div>\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Assign Tenant to Unit</h3>\r\n              </div>\r\n              \r\n              {/* Content */}\r\n              <div className=\"mb-6\">\r\n                <p className=\"text-gray-600 mb-4\">\r\n                  Are you sure you want to assign <strong>{selectedChat?.tenantName || selectedChat?.tenant?.name || 'this tenant'}</strong> to <strong>{selectedChat?.unitName || 'a unit'}</strong> in <strong>{selectedChat?.property || 'this property'}</strong>?\r\n                </p>\r\n                \r\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\r\n                  <p className=\"text-sm text-yellow-800\">\r\n                    <strong>Warning:</strong> This will change the unit status from vacant to occupied and create a tenancy record.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Actions */}\r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={() => setShowAssignModal(false)}\r\n                  disabled={assigning}\r\n                  className=\"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleAssignTenant}\r\n                  disabled={assigning}\r\n                  className=\"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors\"\r\n                >\r\n                  {assigning ? (\r\n                    <>\r\n                      <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                      </svg>\r\n                      Assigning...\r\n                    </>\r\n                  ) : (\r\n                    'Confirm Assignment'\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Inquiries;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}