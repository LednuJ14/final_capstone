{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lenovo\\\\OneDrive\\\\Desktop\\\\Capstone-Project-jun\\\\main-domain\\\\frontend\\\\src\\\\components\\\\Tenants\\\\PropertyGrid.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport PropertyCard from './PropertyCard';\nimport UnitDetails from './UnitDetails';\nimport Inquiries from './Inquiries';\nimport Pagination from './Pagination';\nimport ApiService from '../../services/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PropertyGrid = ({\n  filters = {}\n}) => {\n  _s();\n  const [selectedProperty, setSelectedProperty] = useState(null);\n  const [properties, setProperties] = useState([]);\n  const [loading, setLoading] = useState(true); // retained for future spinner, but not used\n  const [page, setPage] = useState(1);\n  const [perPage] = useState(9);\n  const [pagination, setPagination] = useState({\n    page: 1,\n    per_page: 9,\n    total_pages: 1,\n    total_items: 0\n  });\n  const [showInquiries, setShowInquiries] = useState(false);\n  const [inquiryContext, setInquiryContext] = useState(null);\n\n  // Check for pending inquiry after login and restore it\n  useEffect(() => {\n    try {\n      const pendingInquiry = sessionStorage.getItem('pending_inquiry');\n      if (pendingInquiry) {\n        const accessToken = localStorage.getItem('access_token');\n        const userRole = localStorage.getItem('user_role');\n\n        // Only restore if user is now logged in\n        if (accessToken && userRole) {\n          const inquiryData = JSON.parse(pendingInquiry);\n          setInquiryContext(inquiryData);\n          setShowInquiries(true);\n          // Clear pending inquiry after restoring\n          sessionStorage.removeItem('pending_inquiry');\n        }\n      }\n    } catch (e) {\n      console.warn('Failed to restore pending inquiry:', e);\n    }\n  }, []); // Run once on mount\n\n  // Fetch properties from API\n  useEffect(() => {\n    const fetchProperties = async () => {\n      try {\n        // Prepare API params - pass filters to backend for server-side filtering\n        const apiParams = {\n          page: page,\n          per_page: perPage\n        };\n\n        // Add filters to API params\n        if (filters.type) {\n          apiParams.type = filters.type;\n        }\n        if (filters.min_price) {\n          apiParams.min_price = filters.min_price;\n        }\n        if (filters.max_price) {\n          apiParams.max_price = filters.max_price;\n        }\n        if (filters.bedrooms) {\n          apiParams.bedrooms = filters.bedrooms;\n        }\n        if (filters.search) {\n          apiParams.search = filters.search;\n        }\n\n        // Location filters - prioritize distance-based search if coordinates available\n        if (filters.latitude && filters.longitude) {\n          apiParams.latitude = filters.latitude;\n          apiParams.longitude = filters.longitude;\n          apiParams.radius = filters.radius || 100;\n        } else if (filters.city || filters.location) {\n          // Use text-based location search\n          apiParams.city = filters.city || filters.location;\n        }\n\n        // Use tenant-accessible endpoint to get active properties with filters\n        const response = await ApiService.getActiveProperties(apiParams);\n\n        // Handle different response formats\n        let properties = [];\n        if (response !== null && response !== void 0 && response.properties && Array.isArray(response.properties)) {\n          properties = response.properties;\n        } else if (response !== null && response !== void 0 && response.items && Array.isArray(response.items)) {\n          properties = response.items;\n        } else if (Array.isArray(response)) {\n          properties = response;\n        }\n\n        // Update pagination from API response\n        if (response !== null && response !== void 0 && response.pagination) {\n          setPagination({\n            page: response.pagination.page || page,\n            per_page: response.pagination.per_page || perPage,\n            total_pages: response.pagination.pages || response.pagination.total_pages || 1,\n            total_items: response.pagination.total_items || response.pagination.total || 0\n          });\n        }\n\n        // Client-side search filter (for text search in title, description, etc.)\n        // Backend handles location, type, price filters - we only do text search here\n        let filteredProperties = properties;\n        if (filters.search) {\n          const searchTerm = (filters.search || '').toLowerCase().trim();\n          if (searchTerm) {\n            filteredProperties = filteredProperties.filter(prop => {\n              var _prop$unit_details;\n              const searchableText = [prop.title || '', prop.description || '', prop.street || '', prop.barangay || '', prop.city || '', prop.province || '', prop.property_type || '', ...(Array.isArray(prop.images) ? prop.images : []).map(img => img || ''), ...Object.keys(((_prop$unit_details = prop.unit_details) === null || _prop$unit_details === void 0 ? void 0 : _prop$unit_details.amenities) || {}).filter(key => prop.unit_details.amenities[key])].join(' ').toLowerCase();\n              return searchableText.includes(searchTerm);\n            });\n          }\n        }\n        const cards = filteredProperties.map((property, index) => {\n          var _property$owner;\n          const images = Array.isArray(property.images) ? property.images : [];\n          const normalizedImages = images.map(img => {\n            if (typeof img === 'string' && img.startsWith('/uploads/')) {\n              return `http://localhost:5000${img}`;\n            }\n            return img;\n          });\n          const unit = property.unit_details || {};\n          const contact = property.contact_info || {};\n          const propertyInfo = property.property_info || {};\n          const financialInfo = property.financial_info || {};\n          const availabilityInfo = property.availability_info || {};\n          return {\n            id: `prop-${property.property_id || property.id}-${index}`,\n            unitId: property.id,\n            // Unit ID from backend\n            name: property.title,\n            images: normalizedImages,\n            // Location details - exact location (prioritize street and barangay)\n            location: (() => {\n              const parts = [];\n              if (property.street) parts.push(property.street);\n              if (property.barangay) parts.push(property.barangay);\n              if (property.city) parts.push(property.city);\n              if (property.province && !parts.includes(property.province)) parts.push(property.province);\n              return parts.length > 0 ? parts.join(', ') : property.city && property.province ? `${property.city}, ${property.province}` : property.city || property.province || 'Location not specified';\n            })(),\n            street: property.street || '',\n            barangay: property.barangay || '',\n            city: property.city || '',\n            province: property.province || '',\n            postalCode: property.postal_code || '',\n            price: `₱${Number(property.monthly_rent || 0).toLocaleString()}/month`,\n            imageAlt: `${property.title} - Property image`,\n            // Basic\n            description: property.description || propertyInfo.property_description || '',\n            propertyType: property.property_type,\n            status: property.status || availabilityInfo.unit_status,\n            // Unit details\n            bedrooms: property.bedrooms,\n            bathrooms: property.bathrooms,\n            // 'own' or 'share'\n            area: property.floor_area,\n            furnished: unit.furnished || false,\n            parkingSpaces: unit.parking_spaces || 0,\n            floorNumber: unit.floor_number || '',\n            unitStatus: unit.unit_status || availabilityInfo.unit_status || property.status,\n            unitDetails: unit,\n            amenities: unit.amenities || {},\n            securityDeposit: Number(financialInfo.security_deposit || unit.security_deposit || 0),\n            // Financial\n            monthlyRent: Number(property.monthly_rent || financialInfo.monthly_rent || 0),\n            // Property Info\n            buildingName: propertyInfo.building_name || '',\n            address: (() => {\n              // Build address from components, fallback to full address string\n              const parts = [];\n              if (property.street) parts.push(property.street);\n              if (property.barangay) parts.push(property.barangay);\n              if (property.city) parts.push(property.city);\n              if (property.province) parts.push(property.province);\n              if (property.postal_code) parts.push(property.postal_code);\n              return parts.length > 0 ? parts.join(', ') : propertyInfo.address || property.address || '';\n            })(),\n            propertyTitle: propertyInfo.property_title || property.title,\n            propertyDescription: propertyInfo.property_description || property.description,\n            // Contact\n            contactEmail: contact.email || property.contact_email || '',\n            contactPhone: contact.phone || property.contact_phone || '',\n            contactPerson: contact.contact_person || propertyInfo.contact_person || '',\n            // Keep for inquiries routing\n            managerId: ((_property$owner = property.owner) === null || _property$owner === void 0 ? void 0 : _property$owner.id) || null,\n            propertyId: property.property_id || property.id,\n            // Additional info\n            unitName: property.unit_name || '',\n            createdAt: property.created_at,\n            updatedAt: property.updated_at\n          };\n        });\n        setProperties(cards);\n        // Pagination is already set from API response above (if available)\n        // If API didn't return pagination, set default\n        if (!(response !== null && response !== void 0 && response.pagination)) {\n          setPagination({\n            page: 1,\n            per_page: perPage,\n            total_pages: 1,\n            total_items: cards.length\n          });\n        }\n      } catch (error) {\n        console.error('Error fetching properties:', error);\n        setProperties([]);\n        setPagination({\n          page: 1,\n          per_page: perPage,\n          total_pages: 1,\n          total_items: 0\n        });\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchProperties();\n  }, [filters, page, perPage]);\n  const handleCardClick = property => {\n    setSelectedProperty(property);\n  };\n  const handleCloseModal = () => {\n    setSelectedProperty(null);\n  };\n  const handleInquireNow = unit => {\n    // Check if user is authenticated before allowing inquiry\n    const accessToken = localStorage.getItem('access_token');\n    const userRole = localStorage.getItem('user_role');\n\n    // Extract property_id correctly - handle format \"prop-{property_id}-{index}\"\n    let numericPropertyId = null;\n    if (unit.propertyId || unit.property_id) {\n      // If property already has propertyId from backend\n      numericPropertyId = Number(unit.propertyId || unit.property_id);\n    } else if (unit.id) {\n      // Extract from ID format \"prop-{property_id}-{index}\"\n      const match = String(unit.id).match(/^prop-(\\d+)(?:-\\d+)?$/);\n      if (match) {\n        numericPropertyId = Number(match[1]);\n      } else {\n        // Fallback: try to extract any number\n        const numMatch = String(unit.id).match(/\\d+/);\n        numericPropertyId = numMatch ? Number(numMatch[0]) : null;\n      }\n    }\n    if (!numericPropertyId) {\n      console.error('Could not extract property ID from unit:', unit);\n      alert('Error: Could not identify property. Please try again.');\n      return;\n    }\n    if (!accessToken || !userRole) {\n      // User is not logged in - show alert and store inquiry context for after login\n      const inquiryData = {\n        managerName: unit.propertyManager || 'Property Manager',\n        property: unit.name,\n        unitId: numericPropertyId,\n        propertyId: numericPropertyId,\n        managerId: unit.managerId || null\n      };\n\n      // Store inquiry context in sessionStorage for after login\n      try {\n        sessionStorage.setItem('pending_inquiry', JSON.stringify(inquiryData));\n      } catch (e) {\n        console.warn('Failed to store pending inquiry:', e);\n      }\n\n      // Show user-friendly alert\n      alert('Please log in to make an inquiry. You will be redirected to the login page.');\n\n      // Redirect to login - trigger a custom event or use window location\n      try {\n        window.dispatchEvent(new CustomEvent('navigateToLogin', {\n          detail: {\n            returnTo: 'dashboard'\n          }\n        }));\n      } catch (e) {\n        console.warn('Could not trigger navigation event:', e);\n      }\n      return; // Prevent inquiry from proceeding\n    }\n\n    // User is authenticated - proceed with inquiry\n    setInquiryContext({\n      managerName: unit.propertyManager || 'Property Manager',\n      property: unit.name,\n      unitId: numericPropertyId,\n      propertyId: numericPropertyId,\n      managerId: unit.managerId || null\n    });\n    setShowInquiries(true);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl md:text-2xl font-bold text-black mb-6\",\n        children: \"RENT SPACE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\",\n        children: properties.map(property => /*#__PURE__*/_jsxDEV(PropertyCard, {\n          images: property.images,\n          location: property.location,\n          price: property.price,\n          imageAlt: property.imageAlt,\n          bedrooms: property.bedrooms,\n          bathrooms: property.bathrooms,\n          area: property.area,\n          propertyType: property.propertyType,\n          street: property.street,\n          barangay: property.barangay,\n          city: property.city,\n          province: property.province,\n          onCardClick: () => handleCardClick(property)\n        }, property.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n      currentPage: pagination.page || page,\n      totalPages: pagination.total_pages || 1,\n      onPageChange: p => setPage(p)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 7\n    }, this), selectedProperty && /*#__PURE__*/_jsxDEV(UnitDetails, {\n      property: selectedProperty,\n      onClose: handleCloseModal,\n      onInquireNow: propertyData => {\n        // Close the unit details modal and open inquiries\n        handleCloseModal();\n        handleInquireNow(propertyData || selectedProperty);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 9\n    }, this), showInquiries && /*#__PURE__*/_jsxDEV(Inquiries, {\n      onClose: () => setShowInquiries(false),\n      initialChat: inquiryContext\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(PropertyGrid, \"rSi0e5wSm9K7NId+jb44ZYRrvFA=\");\n_c = PropertyGrid;\nexport default PropertyGrid;\nvar _c;\n$RefreshReg$(_c, \"PropertyGrid\");","map":{"version":3,"names":["React","useState","useEffect","PropertyCard","UnitDetails","Inquiries","Pagination","ApiService","jsxDEV","_jsxDEV","Fragment","_Fragment","PropertyGrid","filters","_s","selectedProperty","setSelectedProperty","properties","setProperties","loading","setLoading","page","setPage","perPage","pagination","setPagination","per_page","total_pages","total_items","showInquiries","setShowInquiries","inquiryContext","setInquiryContext","pendingInquiry","sessionStorage","getItem","accessToken","localStorage","userRole","inquiryData","JSON","parse","removeItem","e","console","warn","fetchProperties","apiParams","type","min_price","max_price","bedrooms","search","latitude","longitude","radius","city","location","response","getActiveProperties","Array","isArray","items","pages","total","filteredProperties","searchTerm","toLowerCase","trim","filter","prop","_prop$unit_details","searchableText","title","description","street","barangay","province","property_type","images","map","img","Object","keys","unit_details","amenities","key","join","includes","cards","property","index","_property$owner","normalizedImages","startsWith","unit","contact","contact_info","propertyInfo","property_info","financialInfo","financial_info","availabilityInfo","availability_info","id","property_id","unitId","name","parts","push","length","postalCode","postal_code","price","Number","monthly_rent","toLocaleString","imageAlt","property_description","propertyType","status","unit_status","bathrooms","area","floor_area","furnished","parkingSpaces","parking_spaces","floorNumber","floor_number","unitStatus","unitDetails","securityDeposit","security_deposit","monthlyRent","buildingName","building_name","address","propertyTitle","property_title","propertyDescription","contactEmail","email","contact_email","contactPhone","phone","contact_phone","contactPerson","contact_person","managerId","owner","propertyId","unitName","unit_name","createdAt","created_at","updatedAt","updated_at","error","handleCardClick","handleCloseModal","handleInquireNow","numericPropertyId","match","String","numMatch","alert","managerName","propertyManager","setItem","stringify","window","dispatchEvent","CustomEvent","detail","returnTo","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onCardClick","currentPage","totalPages","onPageChange","p","onClose","onInquireNow","propertyData","initialChat","_c","$RefreshReg$"],"sources":["C:/Users/Lenovo/OneDrive/Desktop/Capstone-Project-jun/main-domain/frontend/src/components/Tenants/PropertyGrid.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport PropertyCard from './PropertyCard';\r\nimport UnitDetails from './UnitDetails';\r\nimport Inquiries from './Inquiries';\r\nimport Pagination from './Pagination';\r\nimport ApiService from '../../services/api';\r\n\r\nconst PropertyGrid = ({ filters = {} }) => {\r\n  const [selectedProperty, setSelectedProperty] = useState(null);\r\n  const [properties, setProperties] = useState([]);\r\n  const [loading, setLoading] = useState(true); // retained for future spinner, but not used\r\n  const [page, setPage] = useState(1);\r\n  const [perPage] = useState(9);\r\n  const [pagination, setPagination] = useState({ page: 1, per_page: 9, total_pages: 1, total_items: 0 });\r\n  const [showInquiries, setShowInquiries] = useState(false);\r\n  const [inquiryContext, setInquiryContext] = useState(null);\r\n\r\n  // Check for pending inquiry after login and restore it\r\n  useEffect(() => {\r\n    try {\r\n      const pendingInquiry = sessionStorage.getItem('pending_inquiry');\r\n      if (pendingInquiry) {\r\n        const accessToken = localStorage.getItem('access_token');\r\n        const userRole = localStorage.getItem('user_role');\r\n        \r\n        // Only restore if user is now logged in\r\n        if (accessToken && userRole) {\r\n          const inquiryData = JSON.parse(pendingInquiry);\r\n          setInquiryContext(inquiryData);\r\n          setShowInquiries(true);\r\n          // Clear pending inquiry after restoring\r\n          sessionStorage.removeItem('pending_inquiry');\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('Failed to restore pending inquiry:', e);\r\n    }\r\n  }, []); // Run once on mount\r\n\r\n  // Fetch properties from API\r\n  useEffect(() => {\r\n    const fetchProperties = async () => {\r\n      try {\r\n        // Prepare API params - pass filters to backend for server-side filtering\r\n        const apiParams = {\r\n          page: page,\r\n          per_page: perPage\r\n        };\r\n        \r\n        // Add filters to API params\r\n        if (filters.type) {\r\n          apiParams.type = filters.type;\r\n        }\r\n        if (filters.min_price) {\r\n          apiParams.min_price = filters.min_price;\r\n        }\r\n        if (filters.max_price) {\r\n          apiParams.max_price = filters.max_price;\r\n        }\r\n        if (filters.bedrooms) {\r\n          apiParams.bedrooms = filters.bedrooms;\r\n        }\r\n        if (filters.search) {\r\n          apiParams.search = filters.search;\r\n        }\r\n        \r\n        // Location filters - prioritize distance-based search if coordinates available\r\n        if (filters.latitude && filters.longitude) {\r\n          apiParams.latitude = filters.latitude;\r\n          apiParams.longitude = filters.longitude;\r\n          apiParams.radius = filters.radius || 100;\r\n        } else if (filters.city || filters.location) {\r\n          // Use text-based location search\r\n          apiParams.city = filters.city || filters.location;\r\n        }\r\n        \r\n        // Use tenant-accessible endpoint to get active properties with filters\r\n        const response = await ApiService.getActiveProperties(apiParams);\r\n        \r\n        // Handle different response formats\r\n        let properties = [];\r\n        if (response?.properties && Array.isArray(response.properties)) {\r\n          properties = response.properties;\r\n        } else if (response?.items && Array.isArray(response.items)) {\r\n          properties = response.items;\r\n        } else if (Array.isArray(response)) {\r\n          properties = response;\r\n        }\r\n        \r\n        // Update pagination from API response\r\n        if (response?.pagination) {\r\n          setPagination({\r\n            page: response.pagination.page || page,\r\n            per_page: response.pagination.per_page || perPage,\r\n            total_pages: response.pagination.pages || response.pagination.total_pages || 1,\r\n            total_items: response.pagination.total_items || response.pagination.total || 0\r\n          });\r\n        }\r\n        \r\n        // Client-side search filter (for text search in title, description, etc.)\r\n        // Backend handles location, type, price filters - we only do text search here\r\n        let filteredProperties = properties;\r\n        \r\n        if (filters.search) {\r\n          const searchTerm = (filters.search || '').toLowerCase().trim();\r\n          if (searchTerm) {\r\n            filteredProperties = filteredProperties.filter(prop => {\r\n              const searchableText = [\r\n                prop.title || '',\r\n                prop.description || '',\r\n                prop.street || '',\r\n                prop.barangay || '',\r\n                prop.city || '',\r\n                prop.province || '',\r\n                prop.property_type || '',\r\n                ...(Array.isArray(prop.images) ? prop.images : []).map(img => img || ''),\r\n                ...Object.keys(prop.unit_details?.amenities || {}).filter(key => prop.unit_details.amenities[key])\r\n              ].join(' ').toLowerCase();\r\n              return searchableText.includes(searchTerm);\r\n            });\r\n          }\r\n        }\r\n\r\n        const cards = filteredProperties.map((property, index) => {\r\n          const images = Array.isArray(property.images) ? property.images : [];\r\n          const normalizedImages = images.map((img) => {\r\n            if (typeof img === 'string' && img.startsWith('/uploads/')) {\r\n              return `http://localhost:5000${img}`;\r\n            }\r\n            return img;\r\n          });\r\n          const unit = property.unit_details || {};\r\n          const contact = property.contact_info || {};\r\n          const propertyInfo = property.property_info || {};\r\n          const financialInfo = property.financial_info || {};\r\n          const availabilityInfo = property.availability_info || {};\r\n          \r\n          return {\r\n            id: `prop-${property.property_id || property.id}-${index}`,\r\n            unitId: property.id, // Unit ID from backend\r\n            name: property.title,\r\n            images: normalizedImages,\r\n            // Location details - exact location (prioritize street and barangay)\r\n            location: (() => {\r\n              const parts = [];\r\n              if (property.street) parts.push(property.street);\r\n              if (property.barangay) parts.push(property.barangay);\r\n              if (property.city) parts.push(property.city);\r\n              if (property.province && !parts.includes(property.province)) parts.push(property.province);\r\n              return parts.length > 0 ? parts.join(', ') : (property.city && property.province ? `${property.city}, ${property.province}` : property.city || property.province || 'Location not specified');\r\n            })(),\r\n            street: property.street || '',\r\n            barangay: property.barangay || '',\r\n            city: property.city || '',\r\n            province: property.province || '',\r\n            postalCode: property.postal_code || '',\r\n            price: `₱${Number(property.monthly_rent || 0).toLocaleString()}/month`,\r\n            imageAlt: `${property.title} - Property image`,\r\n            // Basic\r\n            description: property.description || propertyInfo.property_description || '',\r\n            propertyType: property.property_type,\r\n            status: property.status || availabilityInfo.unit_status,\r\n            // Unit details\r\n            bedrooms: property.bedrooms,\r\n            bathrooms: property.bathrooms, // 'own' or 'share'\r\n            area: property.floor_area,\r\n            furnished: unit.furnished || false,\r\n            parkingSpaces: unit.parking_spaces || 0,\r\n            floorNumber: unit.floor_number || '',\r\n            unitStatus: unit.unit_status || availabilityInfo.unit_status || property.status,\r\n            unitDetails: unit,\r\n            amenities: unit.amenities || {},\r\n            securityDeposit: Number(financialInfo.security_deposit || unit.security_deposit || 0),\r\n            // Financial\r\n            monthlyRent: Number(property.monthly_rent || financialInfo.monthly_rent || 0),\r\n            // Property Info\r\n            buildingName: propertyInfo.building_name || '',\r\n            address: (() => {\r\n              // Build address from components, fallback to full address string\r\n              const parts = [];\r\n              if (property.street) parts.push(property.street);\r\n              if (property.barangay) parts.push(property.barangay);\r\n              if (property.city) parts.push(property.city);\r\n              if (property.province) parts.push(property.province);\r\n              if (property.postal_code) parts.push(property.postal_code);\r\n              return parts.length > 0 ? parts.join(', ') : (propertyInfo.address || property.address || '');\r\n            })(),\r\n            propertyTitle: propertyInfo.property_title || property.title,\r\n            propertyDescription: propertyInfo.property_description || property.description,\r\n            // Contact\r\n            contactEmail: contact.email || property.contact_email || '',\r\n            contactPhone: contact.phone || property.contact_phone || '',\r\n            contactPerson: contact.contact_person || propertyInfo.contact_person || '',\r\n            // Keep for inquiries routing\r\n            managerId: property.owner?.id || null,\r\n            propertyId: property.property_id || property.id,\r\n            // Additional info\r\n            unitName: property.unit_name || '',\r\n            createdAt: property.created_at,\r\n            updatedAt: property.updated_at,\r\n          };\r\n        });\r\n\r\n        setProperties(cards);\r\n        // Pagination is already set from API response above (if available)\r\n        // If API didn't return pagination, set default\r\n        if (!response?.pagination) {\r\n          setPagination({ page: 1, per_page: perPage, total_pages: 1, total_items: cards.length });\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching properties:', error);\r\n        setProperties([]);\r\n        setPagination({ page: 1, per_page: perPage, total_pages: 1, total_items: 0 });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProperties();\r\n  }, [filters, page, perPage]);\r\n\r\n\r\n  const handleCardClick = (property) => {\r\n    setSelectedProperty(property);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setSelectedProperty(null);\r\n  };\r\n\r\n  const handleInquireNow = (unit) => {\r\n    // Check if user is authenticated before allowing inquiry\r\n    const accessToken = localStorage.getItem('access_token');\r\n    const userRole = localStorage.getItem('user_role');\r\n    \r\n    // Extract property_id correctly - handle format \"prop-{property_id}-{index}\"\r\n    let numericPropertyId = null;\r\n    if (unit.propertyId || unit.property_id) {\r\n      // If property already has propertyId from backend\r\n      numericPropertyId = Number(unit.propertyId || unit.property_id);\r\n    } else if (unit.id) {\r\n      // Extract from ID format \"prop-{property_id}-{index}\"\r\n      const match = String(unit.id).match(/^prop-(\\d+)(?:-\\d+)?$/);\r\n      if (match) {\r\n        numericPropertyId = Number(match[1]);\r\n      } else {\r\n        // Fallback: try to extract any number\r\n        const numMatch = String(unit.id).match(/\\d+/);\r\n        numericPropertyId = numMatch ? Number(numMatch[0]) : null;\r\n      }\r\n    }\r\n    \r\n    if (!numericPropertyId) {\r\n      console.error('Could not extract property ID from unit:', unit);\r\n      alert('Error: Could not identify property. Please try again.');\r\n      return;\r\n    }\r\n    \r\n    if (!accessToken || !userRole) {\r\n      // User is not logged in - show alert and store inquiry context for after login\r\n      const inquiryData = {\r\n        managerName: unit.propertyManager || 'Property Manager',\r\n        property: unit.name,\r\n        unitId: numericPropertyId,\r\n        propertyId: numericPropertyId,\r\n        managerId: unit.managerId || null\r\n      };\r\n      \r\n      // Store inquiry context in sessionStorage for after login\r\n      try {\r\n        sessionStorage.setItem('pending_inquiry', JSON.stringify(inquiryData));\r\n      } catch (e) {\r\n        console.warn('Failed to store pending inquiry:', e);\r\n      }\r\n      \r\n      // Show user-friendly alert\r\n      alert('Please log in to make an inquiry. You will be redirected to the login page.');\r\n      \r\n      // Redirect to login - trigger a custom event or use window location\r\n      try {\r\n        window.dispatchEvent(new CustomEvent('navigateToLogin', { \r\n          detail: { returnTo: 'dashboard' } \r\n        }));\r\n      } catch (e) {\r\n        console.warn('Could not trigger navigation event:', e);\r\n      }\r\n      \r\n      return; // Prevent inquiry from proceeding\r\n    }\r\n    \r\n    // User is authenticated - proceed with inquiry\r\n    setInquiryContext({\r\n      managerName: unit.propertyManager || 'Property Manager',\r\n      property: unit.name,\r\n      unitId: numericPropertyId,\r\n      propertyId: numericPropertyId,\r\n      managerId: unit.managerId || null\r\n    });\r\n    setShowInquiries(true);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"mb-8\">\r\n        <h2 className=\"text-xl md:text-2xl font-bold text-black mb-6\">RENT SPACE</h2>\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\r\n          {properties.map((property) => (\r\n            <PropertyCard\r\n              key={property.id}\r\n              images={property.images}\r\n              location={property.location}\r\n              price={property.price}\r\n              imageAlt={property.imageAlt}\r\n              bedrooms={property.bedrooms}\r\n              bathrooms={property.bathrooms}\r\n              area={property.area}\r\n              propertyType={property.propertyType}\r\n              street={property.street}\r\n              barangay={property.barangay}\r\n              city={property.city}\r\n              province={property.province}\r\n              onCardClick={() => handleCardClick(property)}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <Pagination \r\n        currentPage={pagination.page || page}\r\n        totalPages={pagination.total_pages || 1}\r\n        onPageChange={(p) => setPage(p)}\r\n      />\r\n\r\n      {/* Unit Details Modal */}\r\n      {selectedProperty && (\r\n        <UnitDetails \r\n          property={selectedProperty} \r\n          onClose={handleCloseModal}\r\n          onInquireNow={(propertyData) => {\r\n            // Close the unit details modal and open inquiries\r\n            handleCloseModal();\r\n            handleInquireNow(propertyData || selectedProperty);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {showInquiries && (\r\n        <Inquiries onClose={() => setShowInquiries(false)} initialChat={inquiryContext} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PropertyGrid;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}